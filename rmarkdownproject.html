

Project Assignment on Practical Machine Learning

Nayan Pandya

December 1, 2019


Project: Practical machine learning


Background

Using devices such as Jawbone Up, Nike FuelBand, and Fitbit it is now possible to collect a large amount of data about personal activity relatively inexpensively. These type of devices are part of the quantified self movement - a group of enthusiasts who take measurements about themselves regularly to improve their health, to find patterns in their behavior, or because they are tech geeks. One thing that people regularly do is quantify how much of a particular activity they do, but they rarely quantify how well they do it. In this project, your goal will be to use data from accelerometers on the belt, forearm, arm, and dumbell of 6 participants. They were asked to perform barbell lifts correctly and incorrectly in 5 different ways. More information is available from the website here: http://web.archive.org/web/20161224072740/http:/groupware.les.inf.puc-rio.br/har (see the section on the Weight Lifting Exercise Dataset)


Data

The training data for this project are available here:

https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv

The test data are available here:

https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv

The data for this project come from this source: http://web.archive.org/web/20161224072740/http:/groupware.les.inf.puc-rio.br/har. If you use the document you create for this class for any purpose please cite them as they have been very generous in allowing their data to be used for this kind of assignment.

the content summary of weight lifting dataset: reference from http://groupware.les.inf.puc-rio.br/har#weight_lifting_exercises

Six young health participants were asked to perform one set of 10 repetitions of the Unilateral Dumbbell Biceps Curl in five different fashions: exactly according to the specification (Class A), throwing the elbows to the front (Class B), lifting the dumbbell only halfway (Class C), lowering the dumbbell only halfway (Class D) and throwing the hips to the front (Class E).

Class A corresponds to the specified execution of the exercise, while the other 4 classes correspond to common mistakes. Participants were supervised by an experienced weight lifter to make sure the execution complied to the manner they were supposed to simulate. The exercises were performed by six male participants aged between 20-28 years, with little weight lifting experience. We made sure that all participants could easily simulate the mistakes in a safe and controlled manner by using a relatively light dumbbell (1.25kg)."


Acknowledgement

Data is from: Velloso, E.; Bulling, A.; Gellersen, H.; Ugulino, W.; Fuks, H. Qualitative Activity Recognition of Weight Lifting Exercises. Proceedings of 4th International Conference in Cooperation with SIGCHI (Augmented Human â€™13) . Stuttgart, Germany: ACM SIGCHI, 2013.


step by step procedure to built prediction
1.loading data from testing and training data set
2.remove unwanted column where we have less than 60% records.
3.check multi-colinearity
4.use VIF function to remove colinear variable
5.check accuracy of three types of model and use best method to predict testing data set. ## Read library to use packages for programme
library(rpart)
library(caret)
## Loading required package: lattice
## Loading required package: ggplot2
library(ROSE)
## Loaded ROSE 0.0-3
library(Hmisc)
## Loading required package: survival
## 
## Attaching package: 'survival'
## The following object is masked from 'package:caret':
## 
##     cluster
## The following object is masked from 'package:rpart':
## 
##     solder
## Loading required package: Formula
## 
## Attaching package: 'Hmisc'
## The following objects are masked from 'package:base':
## 
##     format.pval, units
library(gridExtra)
library(GGally)
library(dummies)
## dummies-1.5.6 provided by Decision Patterns
library(car)
## Loading required package: carData
library(rpart.plot)
library(rattle)
## Rattle: A free graphical interface for data science with R.
## Version 5.2.0 Copyright (c) 2006-2018 Togaware Pty Ltd.
## Type 'rattle()' to shake, rattle, and roll your data.
library(randomForest)
## randomForest 4.6-14
## Type rfNews() to see new features/changes/bug fixes.
## 
## Attaching package: 'randomForest'
## The following object is masked from 'package:rattle':
## 
##     importance
## The following object is masked from 'package:gridExtra':
## 
##     combine
## The following object is masked from 'package:ggplot2':
## 
##     margin
library(knitr)

set.seed(3546)


Read file from location
# setting working directory where traing and testing dataset stored
setwd("C:/D drive/Digital strategy/field data/coursera/practical machinelearning/projectwork")
rm(list=ls())
# it is showing number of file exist in above listed folder path
dir()
## [1] "pml-testing.csv"                                       
## [2] "pml-training.csv"                                      
## [3] "Project Assignment on Practical Machine Learning_files"
## [4] "projectassignment.R"                                   
## [5] "rmarkdownproject.html"                                 
## [6] "rmarkdownproject.Rmd"
# Following command is reading .csv file from folder given above
testing <- read.csv("pml-testing.csv")
training <- read.csv("pml-training.csv")


remove with NA columns more than 60%
# it is very important to clean data by replacing NA or removing particular column. Here, we have more than 60% NA in many of column. So we will be removing this column by writing following command. 

training <- training[,-which(colSums(is.na(training))>(0.6*length(training$classe)))]


Partition of data into training and test set
# We need to split training data into train and test data set. We are splitting data such that 80% records will be going into training data set while 20% data will be going into test dataset. 

intrain <- createDataPartition(y=training$classe,p=0.8,list = FALSE)
train_data<- training[intrain,]
test_data <- training[-intrain,]


Remove near zero variable from train and test data
# We are reducing data by removing those columns which has zero variance column. zero variance factor doesn't impact on output   at all. We have splitted data previously, so we will apply treatment for both train and test dataset.    
nsv <- nearZeroVar(train_data,saveMetrics = TRUE)
train_data <- train_data[,-c(which(nsv$nzv== TRUE))]
rm(nsv)
nsv <- nearZeroVar(test_data,saveMetrics = TRUE)
test_data <- test_data[,-c(which(nsv$nzv== TRUE))]


Convert all independent variable into numetic
# Next step, we will be checking multicolinearity so we are converting intiger and factor to numeric vactor to run regression model. Following code is converting complete dataset except predictor variable into numberic.

train_num <- data.frame(lapply(train_data[,-59], function(x) as.numeric((x))))
train_data <- data.frame(train_num,train_data$classe)
test_num <- data.frame(lapply(test_data[,-59], function(x) as.numeric((x))))
test_data <- data.frame(test_num,test_data$classe)


remove identification variable
# There are some idepntification variable which will create trouble while running prediction algorith, so we are removing those from test and train data set.  
train_data <- train_data[,-c(1:5)]
test_data <- test_data[,-c(1:5)]


check multicolineaty
# Our response variable is catagorical variable so we should choose any independent variable as response variable and check multicolinearity

# Check VIF factor and remove variable which has VIF more than 5 but need to check iteratively. Based on multiple itertive run, it was found out that following variables are having multicolinearity so we are removing the same.
train_vif <- train_data[,-c(3,4,5,9,10,11,12,20,22,23,26,27,34,35,36,37,38,47,48,49)]

# Train_vif is our final train data set which will be used for building predictive model. it has 34 column and 15699 row  

str(train_vif)
## 'data.frame':    15699 obs. of  34 variables:
##  $ num_window          : num  11 11 11 12 12 12 12 12 12 12 ...
##  $ roll_belt           : num  1.41 1.41 1.42 1.48 1.48 1.45 1.42 1.42 1.43 1.45 ...
##  $ gyros_belt_x        : num  0 0.02 0 0.02 0.02 0.02 0.02 0.02 0.02 0.03 ...
##  $ gyros_belt_y        : num  0 0 0 0 0.02 0 0 0 0 0 ...
##  $ gyros_belt_z        : num  -0.02 -0.02 -0.02 -0.03 -0.02 -0.02 -0.02 -0.02 -0.02 0 ...
##  $ magnet_belt_y       : num  599 608 600 604 600 603 599 603 602 609 ...
##  $ magnet_belt_z       : num  -313 -311 -305 -310 -302 -312 -311 -313 -312 -308 ...
##  $ roll_arm            : num  -128 -128 -128 -128 -128 -128 -128 -128 -128 -128 ...
##  $ pitch_arm           : num  22.5 22.5 22.5 22.1 22.1 22 21.9 21.8 21.7 21.6 ...
##  $ yaw_arm             : num  -161 -161 -161 -161 -161 -161 -161 -161 -161 -161 ...
##  $ total_accel_arm     : num  34 34 34 34 34 34 34 34 34 34 ...
##  $ gyros_arm_x         : num  0 0.02 0.02 0.02 0 0.02 0 0.02 0.02 0.02 ...
##  $ gyros_arm_z         : num  -0.02 -0.02 -0.02 0.02 0 0 0 0 -0.02 -0.02 ...
##  $ accel_arm_z         : num  -123 -125 -126 -123 -123 -122 -125 -124 -122 -124 ...
##  $ magnet_arm_x        : num  -368 -369 -368 -372 -374 -369 -373 -372 -369 -376 ...
##  $ roll_dumbbell       : num  13.1 13.1 12.9 13.4 13.4 ...
##  $ pitch_dumbbell      : num  -70.5 -70.6 -70.3 -70.4 -70.4 ...
##  $ yaw_dumbbell        : num  -84.9 -84.7 -85.1 -84.9 -84.9 ...
##  $ total_accel_dumbbell: num  37 37 37 37 37 37 37 37 37 37 ...
##  $ gyros_dumbbell_x    : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ gyros_dumbbell_y    : num  -0.02 -0.02 -0.02 -0.02 -0.02 -0.02 -0.02 -0.02 -0.02 -0.02 ...
##  $ magnet_dumbbell_y   : num  293 296 298 303 292 294 295 300 292 291 ...
##  $ magnet_dumbbell_z   : num  -65 -64 -63 -60 -68 -66 -70 -74 -65 -69 ...
##  $ roll_forearm        : num  28.4 28.3 28.3 28.1 28 27.9 27.9 27.8 27.7 27.7 ...
##  $ pitch_forearm       : num  -63.9 -63.9 -63.9 -63.9 -63.9 -63.9 -63.9 -63.8 -63.8 -63.8 ...
##  $ yaw_forearm         : num  -153 -153 -152 -152 -152 -152 -152 -152 -152 -152 ...
##  $ total_accel_forearm : num  36 36 36 36 36 36 36 36 36 36 ...
##  $ gyros_forearm_x     : num  0.03 0.02 0.03 0.02 0.02 0.02 0.02 0.02 0.03 0.02 ...
##  $ gyros_forearm_y     : num  0 0 -0.02 -0.02 0 -0.02 0 -0.02 0 0 ...
##  $ accel_forearm_z     : num  -215 -216 -213 -214 -214 -215 -215 -213 -214 -215 ...
##  $ magnet_forearm_x    : num  -17 -18 -18 -16 -17 -9 -18 -9 -16 -22 ...
##  $ magnet_forearm_y    : num  654 661 658 658 655 660 659 660 653 656 ...
##  $ magnet_forearm_z    : num  476 473 469 469 473 478 470 474 476 473 ...
##  $ train_data.classe   : Factor w/ 5 levels "A","B","C","D",..: 1 1 1 1 1 1 1 1 1 1 ...
dim(train_vif)
## [1] 15699    34
## same treatment was applied for test_vif so that nuber of column and column name are unique with train_vif data set.
test_vif <- test_data[,-c(3,4,5,9,10,11,12,20,22,23,26,27,34,35,36,37,38,47,48,49)]
# test_vif is our final test dataset for calculating out of sample error
dim(test_vif)
## [1] 3923   34


Prediction with using Random Forest
# There are two option to run random forest. 1. use Train fuciton under CARET and 2. call random forest library. we have used called randomforest function to train our model.
library(randomForest)
set.seed(32343)
modelfit_rf <- randomForest(train_data.classe~.,data = train_vif,mtry=6,ntree=2001,importance=TRUE)
# varImpPlot will be plotting significance of different factors.
varImpPlot(modelfit_rf)


# we have used confusion matrix under CARET package to check out of sample error. out of sample accuracy is 0.9973 with using randomforest. 
confusionMatrix(predict(modelfit_rf,test_vif),test_vif$test_data.classe)
## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 1115    1    0    0    0
##          B    1  758    1    0    0
##          C    0    0  683    8    0
##          D    0    0    0  635    0
##          E    0    0    0    0  721
## 
## Overall Statistics
##                                          
##                Accuracy : 0.9972         
##                  95% CI : (0.995, 0.9986)
##     No Information Rate : 0.2845         
##     P-Value [Acc > NIR] : < 2.2e-16      
##                                          
##                   Kappa : 0.9965         
##                                          
##  Mcnemar's Test P-Value : NA             
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity            0.9991   0.9987   0.9985   0.9876   1.0000
## Specificity            0.9996   0.9994   0.9975   1.0000   1.0000
## Pos Pred Value         0.9991   0.9974   0.9884   1.0000   1.0000
## Neg Pred Value         0.9996   0.9997   0.9997   0.9976   1.0000
## Prevalence             0.2845   0.1935   0.1744   0.1639   0.1838
## Detection Rate         0.2842   0.1932   0.1741   0.1619   0.1838
## Detection Prevalence   0.2845   0.1937   0.1761   0.1619   0.1838
## Balanced Accuracy      0.9994   0.9990   0.9980   0.9938   1.0000


Above graph is showing importance of factor for random forest


prediction with using Grediant Boosting Method
set.seed(32343)
modelfit_gbm <- train(train_data.classe~.,data=train_vif,method="gbm") 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1267
##      2        1.5231             nan     0.1000    0.0886
##      3        1.4641             nan     0.1000    0.0675
##      4        1.4195             nan     0.1000    0.0554
##      5        1.3839             nan     0.1000    0.0443
##      6        1.3551             nan     0.1000    0.0464
##      7        1.3263             nan     0.1000    0.0385
##      8        1.3018             nan     0.1000    0.0310
##      9        1.2822             nan     0.1000    0.0350
##     10        1.2590             nan     0.1000    0.0293
##     20        1.1024             nan     0.1000    0.0167
##     40        0.9328             nan     0.1000    0.0097
##     60        0.8315             nan     0.1000    0.0068
##     80        0.7547             nan     0.1000    0.0044
##    100        0.6890             nan     0.1000    0.0032
##    120        0.6358             nan     0.1000    0.0033
##    140        0.5887             nan     0.1000    0.0031
##    150        0.5686             nan     0.1000    0.0029
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1869
##      2        1.4878             nan     0.1000    0.1280
##      3        1.4034             nan     0.1000    0.0964
##      4        1.3397             nan     0.1000    0.0879
##      5        1.2843             nan     0.1000    0.0713
##      6        1.2387             nan     0.1000    0.0603
##      7        1.1999             nan     0.1000    0.0539
##      8        1.1654             nan     0.1000    0.0539
##      9        1.1314             nan     0.1000    0.0517
##     10        1.0991             nan     0.1000    0.0374
##     20        0.8832             nan     0.1000    0.0177
##     40        0.6615             nan     0.1000    0.0094
##     60        0.5191             nan     0.1000    0.0076
##     80        0.4233             nan     0.1000    0.0066
##    100        0.3401             nan     0.1000    0.0057
##    120        0.2830             nan     0.1000    0.0042
##    140        0.2367             nan     0.1000    0.0022
##    150        0.2201             nan     0.1000    0.0020
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2299
##      2        1.4632             nan     0.1000    0.1659
##      3        1.3575             nan     0.1000    0.1251
##      4        1.2792             nan     0.1000    0.1020
##      5        1.2145             nan     0.1000    0.0823
##      6        1.1614             nan     0.1000    0.0792
##      7        1.1111             nan     0.1000    0.0641
##      8        1.0698             nan     0.1000    0.0750
##      9        1.0236             nan     0.1000    0.0651
##     10        0.9845             nan     0.1000    0.0517
##     20        0.7289             nan     0.1000    0.0303
##     40        0.4868             nan     0.1000    0.0105
##     60        0.3533             nan     0.1000    0.0089
##     80        0.2544             nan     0.1000    0.0054
##    100        0.1957             nan     0.1000    0.0027
##    120        0.1550             nan     0.1000    0.0021
##    140        0.1222             nan     0.1000    0.0028
##    150        0.1099             nan     0.1000    0.0017
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1271
##      2        1.5241             nan     0.1000    0.0871
##      3        1.4672             nan     0.1000    0.0632
##      4        1.4247             nan     0.1000    0.0535
##      5        1.3888             nan     0.1000    0.0436
##      6        1.3599             nan     0.1000    0.0460
##      7        1.3314             nan     0.1000    0.0360
##      8        1.3088             nan     0.1000    0.0409
##      9        1.2816             nan     0.1000    0.0311
##     10        1.2614             nan     0.1000    0.0299
##     20        1.1038             nan     0.1000    0.0192
##     40        0.9313             nan     0.1000    0.0093
##     60        0.8269             nan     0.1000    0.0054
##     80        0.7520             nan     0.1000    0.0043
##    100        0.6910             nan     0.1000    0.0040
##    120        0.6383             nan     0.1000    0.0035
##    140        0.5920             nan     0.1000    0.0041
##    150        0.5711             nan     0.1000    0.0032
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1811
##      2        1.4883             nan     0.1000    0.1308
##      3        1.4033             nan     0.1000    0.1026
##      4        1.3362             nan     0.1000    0.0812
##      5        1.2835             nan     0.1000    0.0690
##      6        1.2395             nan     0.1000    0.0670
##      7        1.1970             nan     0.1000    0.0513
##      8        1.1636             nan     0.1000    0.0602
##      9        1.1266             nan     0.1000    0.0496
##     10        1.0965             nan     0.1000    0.0535
##     20        0.8795             nan     0.1000    0.0208
##     40        0.6649             nan     0.1000    0.0110
##     60        0.5285             nan     0.1000    0.0127
##     80        0.4211             nan     0.1000    0.0053
##    100        0.3520             nan     0.1000    0.0049
##    120        0.2936             nan     0.1000    0.0053
##    140        0.2490             nan     0.1000    0.0033
##    150        0.2301             nan     0.1000    0.0032
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2288
##      2        1.4632             nan     0.1000    0.1574
##      3        1.3618             nan     0.1000    0.1224
##      4        1.2841             nan     0.1000    0.0982
##      5        1.2205             nan     0.1000    0.0963
##      6        1.1594             nan     0.1000    0.0811
##      7        1.1094             nan     0.1000    0.0734
##      8        1.0626             nan     0.1000    0.0697
##      9        1.0191             nan     0.1000    0.0672
##     10        0.9785             nan     0.1000    0.0466
##     20        0.7336             nan     0.1000    0.0299
##     40        0.4911             nan     0.1000    0.0143
##     60        0.3497             nan     0.1000    0.0086
##     80        0.2672             nan     0.1000    0.0031
##    100        0.2082             nan     0.1000    0.0027
##    120        0.1629             nan     0.1000    0.0009
##    140        0.1297             nan     0.1000    0.0031
##    150        0.1169             nan     0.1000    0.0024
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1274
##      2        1.5228             nan     0.1000    0.0884
##      3        1.4641             nan     0.1000    0.0665
##      4        1.4209             nan     0.1000    0.0530
##      5        1.3859             nan     0.1000    0.0445
##      6        1.3565             nan     0.1000    0.0423
##      7        1.3290             nan     0.1000    0.0365
##      8        1.3054             nan     0.1000    0.0321
##      9        1.2849             nan     0.1000    0.0370
##     10        1.2595             nan     0.1000    0.0291
##     20        1.1024             nan     0.1000    0.0154
##     40        0.9347             nan     0.1000    0.0084
##     60        0.8337             nan     0.1000    0.0056
##     80        0.7547             nan     0.1000    0.0049
##    100        0.6920             nan     0.1000    0.0036
##    120        0.6388             nan     0.1000    0.0028
##    140        0.5923             nan     0.1000    0.0033
##    150        0.5707             nan     0.1000    0.0022
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1829
##      2        1.4902             nan     0.1000    0.1267
##      3        1.4083             nan     0.1000    0.1027
##      4        1.3415             nan     0.1000    0.0821
##      5        1.2885             nan     0.1000    0.0740
##      6        1.2407             nan     0.1000    0.0603
##      7        1.2015             nan     0.1000    0.0639
##      8        1.1617             nan     0.1000    0.0519
##      9        1.1286             nan     0.1000    0.0435
##     10        1.1005             nan     0.1000    0.0407
##     20        0.8855             nan     0.1000    0.0205
##     40        0.6529             nan     0.1000    0.0153
##     60        0.5177             nan     0.1000    0.0114
##     80        0.4078             nan     0.1000    0.0069
##    100        0.3322             nan     0.1000    0.0048
##    120        0.2765             nan     0.1000    0.0026
##    140        0.2360             nan     0.1000    0.0029
##    150        0.2191             nan     0.1000    0.0012
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2288
##      2        1.4624             nan     0.1000    0.1616
##      3        1.3584             nan     0.1000    0.1186
##      4        1.2828             nan     0.1000    0.1010
##      5        1.2184             nan     0.1000    0.0896
##      6        1.1628             nan     0.1000    0.0714
##      7        1.1160             nan     0.1000    0.0730
##      8        1.0701             nan     0.1000    0.0731
##      9        1.0254             nan     0.1000    0.0490
##     10        0.9923             nan     0.1000    0.0603
##     20        0.7355             nan     0.1000    0.0189
##     40        0.4827             nan     0.1000    0.0165
##     60        0.3435             nan     0.1000    0.0077
##     80        0.2546             nan     0.1000    0.0046
##    100        0.1944             nan     0.1000    0.0038
##    120        0.1507             nan     0.1000    0.0022
##    140        0.1237             nan     0.1000    0.0023
##    150        0.1102             nan     0.1000    0.0013
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1290
##      2        1.5233             nan     0.1000    0.0888
##      3        1.4662             nan     0.1000    0.0668
##      4        1.4223             nan     0.1000    0.0532
##      5        1.3870             nan     0.1000    0.0502
##      6        1.3551             nan     0.1000    0.0372
##      7        1.3304             nan     0.1000    0.0415
##      8        1.3047             nan     0.1000    0.0356
##      9        1.2803             nan     0.1000    0.0328
##     10        1.2595             nan     0.1000    0.0276
##     20        1.1031             nan     0.1000    0.0206
##     40        0.9302             nan     0.1000    0.0091
##     60        0.8253             nan     0.1000    0.0070
##     80        0.7488             nan     0.1000    0.0046
##    100        0.6885             nan     0.1000    0.0042
##    120        0.6372             nan     0.1000    0.0039
##    140        0.5910             nan     0.1000    0.0021
##    150        0.5703             nan     0.1000    0.0035
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1817
##      2        1.4921             nan     0.1000    0.1333
##      3        1.4051             nan     0.1000    0.0996
##      4        1.3391             nan     0.1000    0.0799
##      5        1.2864             nan     0.1000    0.0711
##      6        1.2397             nan     0.1000    0.0655
##      7        1.1981             nan     0.1000    0.0652
##      8        1.1578             nan     0.1000    0.0557
##      9        1.1224             nan     0.1000    0.0422
##     10        1.0952             nan     0.1000    0.0451
##     20        0.8709             nan     0.1000    0.0231
##     40        0.6550             nan     0.1000    0.0107
##     60        0.5112             nan     0.1000    0.0106
##     80        0.4051             nan     0.1000    0.0070
##    100        0.3322             nan     0.1000    0.0063
##    120        0.2755             nan     0.1000    0.0036
##    140        0.2371             nan     0.1000    0.0058
##    150        0.2174             nan     0.1000    0.0035
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2317
##      2        1.4652             nan     0.1000    0.1702
##      3        1.3585             nan     0.1000    0.1195
##      4        1.2831             nan     0.1000    0.1037
##      5        1.2173             nan     0.1000    0.0916
##      6        1.1593             nan     0.1000    0.0754
##      7        1.1100             nan     0.1000    0.0673
##      8        1.0684             nan     0.1000    0.0684
##      9        1.0255             nan     0.1000    0.0615
##     10        0.9871             nan     0.1000    0.0517
##     20        0.7370             nan     0.1000    0.0314
##     40        0.4805             nan     0.1000    0.0133
##     60        0.3445             nan     0.1000    0.0108
##     80        0.2518             nan     0.1000    0.0045
##    100        0.1947             nan     0.1000    0.0046
##    120        0.1540             nan     0.1000    0.0012
##    140        0.1221             nan     0.1000    0.0018
##    150        0.1086             nan     0.1000    0.0010
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1252
##      2        1.5249             nan     0.1000    0.0840
##      3        1.4682             nan     0.1000    0.0650
##      4        1.4254             nan     0.1000    0.0528
##      5        1.3897             nan     0.1000    0.0469
##      6        1.3593             nan     0.1000    0.0389
##      7        1.3340             nan     0.1000    0.0386
##      8        1.3092             nan     0.1000    0.0321
##      9        1.2881             nan     0.1000    0.0364
##     10        1.2645             nan     0.1000    0.0272
##     20        1.1118             nan     0.1000    0.0187
##     40        0.9433             nan     0.1000    0.0098
##     60        0.8411             nan     0.1000    0.0070
##     80        0.7629             nan     0.1000    0.0058
##    100        0.6998             nan     0.1000    0.0038
##    120        0.6461             nan     0.1000    0.0034
##    140        0.6014             nan     0.1000    0.0029
##    150        0.5812             nan     0.1000    0.0041
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1800
##      2        1.4935             nan     0.1000    0.1261
##      3        1.4105             nan     0.1000    0.1030
##      4        1.3442             nan     0.1000    0.0811
##      5        1.2914             nan     0.1000    0.0700
##      6        1.2464             nan     0.1000    0.0595
##      7        1.2083             nan     0.1000    0.0663
##      8        1.1681             nan     0.1000    0.0451
##      9        1.1386             nan     0.1000    0.0454
##     10        1.1090             nan     0.1000    0.0402
##     20        0.8930             nan     0.1000    0.0285
##     40        0.6767             nan     0.1000    0.0140
##     60        0.5259             nan     0.1000    0.0153
##     80        0.4160             nan     0.1000    0.0042
##    100        0.3464             nan     0.1000    0.0052
##    120        0.2848             nan     0.1000    0.0023
##    140        0.2425             nan     0.1000    0.0021
##    150        0.2255             nan     0.1000    0.0018
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2227
##      2        1.4660             nan     0.1000    0.1561
##      3        1.3653             nan     0.1000    0.1217
##      4        1.2879             nan     0.1000    0.1024
##      5        1.2219             nan     0.1000    0.0789
##      6        1.1710             nan     0.1000    0.0800
##      7        1.1201             nan     0.1000    0.0823
##      8        1.0690             nan     0.1000    0.0570
##      9        1.0335             nan     0.1000    0.0684
##     10        0.9915             nan     0.1000    0.0564
##     20        0.7382             nan     0.1000    0.0241
##     40        0.4952             nan     0.1000    0.0132
##     60        0.3581             nan     0.1000    0.0069
##     80        0.2688             nan     0.1000    0.0051
##    100        0.2015             nan     0.1000    0.0035
##    120        0.1592             nan     0.1000    0.0021
##    140        0.1264             nan     0.1000    0.0023
##    150        0.1140             nan     0.1000    0.0020
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1257
##      2        1.5259             nan     0.1000    0.0849
##      3        1.4706             nan     0.1000    0.0675
##      4        1.4273             nan     0.1000    0.0516
##      5        1.3940             nan     0.1000    0.0513
##      6        1.3618             nan     0.1000    0.0378
##      7        1.3370             nan     0.1000    0.0402
##      8        1.3123             nan     0.1000    0.0372
##      9        1.2883             nan     0.1000    0.0305
##     10        1.2667             nan     0.1000    0.0300
##     20        1.1070             nan     0.1000    0.0176
##     40        0.9376             nan     0.1000    0.0075
##     60        0.8342             nan     0.1000    0.0073
##     80        0.7567             nan     0.1000    0.0048
##    100        0.6917             nan     0.1000    0.0042
##    120        0.6396             nan     0.1000    0.0038
##    140        0.5943             nan     0.1000    0.0023
##    150        0.5745             nan     0.1000    0.0021
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1923
##      2        1.4870             nan     0.1000    0.1292
##      3        1.4045             nan     0.1000    0.1012
##      4        1.3394             nan     0.1000    0.0841
##      5        1.2843             nan     0.1000    0.0718
##      6        1.2377             nan     0.1000    0.0638
##      7        1.1972             nan     0.1000    0.0468
##      8        1.1657             nan     0.1000    0.0477
##      9        1.1357             nan     0.1000    0.0554
##     10        1.1021             nan     0.1000    0.0412
##     20        0.8867             nan     0.1000    0.0268
##     40        0.6701             nan     0.1000    0.0155
##     60        0.5191             nan     0.1000    0.0069
##     80        0.4097             nan     0.1000    0.0085
##    100        0.3371             nan     0.1000    0.0074
##    120        0.2843             nan     0.1000    0.0027
##    140        0.2395             nan     0.1000    0.0024
##    150        0.2228             nan     0.1000    0.0033
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2294
##      2        1.4627             nan     0.1000    0.1628
##      3        1.3584             nan     0.1000    0.1307
##      4        1.2778             nan     0.1000    0.1005
##      5        1.2148             nan     0.1000    0.0910
##      6        1.1568             nan     0.1000    0.0705
##      7        1.1111             nan     0.1000    0.0716
##      8        1.0658             nan     0.1000    0.0682
##      9        1.0233             nan     0.1000    0.0688
##     10        0.9820             nan     0.1000    0.0419
##     20        0.7289             nan     0.1000    0.0272
##     40        0.4914             nan     0.1000    0.0123
##     60        0.3391             nan     0.1000    0.0066
##     80        0.2578             nan     0.1000    0.0053
##    100        0.2041             nan     0.1000    0.0044
##    120        0.1588             nan     0.1000    0.0039
##    140        0.1261             nan     0.1000    0.0012
##    150        0.1143             nan     0.1000    0.0017
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1277
##      2        1.5240             nan     0.1000    0.0883
##      3        1.4659             nan     0.1000    0.0684
##      4        1.4216             nan     0.1000    0.0546
##      5        1.3865             nan     0.1000    0.0517
##      6        1.3541             nan     0.1000    0.0373
##      7        1.3295             nan     0.1000    0.0408
##      8        1.3042             nan     0.1000    0.0343
##      9        1.2821             nan     0.1000    0.0355
##     10        1.2585             nan     0.1000    0.0287
##     20        1.1054             nan     0.1000    0.0181
##     40        0.9305             nan     0.1000    0.0104
##     60        0.8246             nan     0.1000    0.0069
##     80        0.7461             nan     0.1000    0.0043
##    100        0.6831             nan     0.1000    0.0046
##    120        0.6315             nan     0.1000    0.0045
##    140        0.5880             nan     0.1000    0.0039
##    150        0.5674             nan     0.1000    0.0030
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1817
##      2        1.4907             nan     0.1000    0.1286
##      3        1.4058             nan     0.1000    0.1004
##      4        1.3401             nan     0.1000    0.0886
##      5        1.2827             nan     0.1000    0.0717
##      6        1.2368             nan     0.1000    0.0614
##      7        1.1968             nan     0.1000    0.0533
##      8        1.1617             nan     0.1000    0.0627
##      9        1.1241             nan     0.1000    0.0403
##     10        1.0978             nan     0.1000    0.0516
##     20        0.8840             nan     0.1000    0.0221
##     40        0.6646             nan     0.1000    0.0091
##     60        0.5225             nan     0.1000    0.0085
##     80        0.4169             nan     0.1000    0.0090
##    100        0.3429             nan     0.1000    0.0064
##    120        0.2867             nan     0.1000    0.0027
##    140        0.2415             nan     0.1000    0.0047
##    150        0.2196             nan     0.1000    0.0021
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2296
##      2        1.4613             nan     0.1000    0.1610
##      3        1.3589             nan     0.1000    0.1252
##      4        1.2783             nan     0.1000    0.1013
##      5        1.2140             nan     0.1000    0.0806
##      6        1.1610             nan     0.1000    0.0904
##      7        1.1040             nan     0.1000    0.0640
##      8        1.0631             nan     0.1000    0.0637
##      9        1.0231             nan     0.1000    0.0632
##     10        0.9844             nan     0.1000    0.0536
##     20        0.7287             nan     0.1000    0.0203
##     40        0.4880             nan     0.1000    0.0224
##     60        0.3443             nan     0.1000    0.0062
##     80        0.2530             nan     0.1000    0.0047
##    100        0.1955             nan     0.1000    0.0062
##    120        0.1569             nan     0.1000    0.0035
##    140        0.1250             nan     0.1000    0.0024
##    150        0.1127             nan     0.1000    0.0008
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1279
##      2        1.5245             nan     0.1000    0.0901
##      3        1.4667             nan     0.1000    0.0653
##      4        1.4235             nan     0.1000    0.0546
##      5        1.3872             nan     0.1000    0.0425
##      6        1.3599             nan     0.1000    0.0444
##      7        1.3318             nan     0.1000    0.0354
##      8        1.3086             nan     0.1000    0.0395
##      9        1.2813             nan     0.1000    0.0295
##     10        1.2627             nan     0.1000    0.0298
##     20        1.1057             nan     0.1000    0.0180
##     40        0.9366             nan     0.1000    0.0078
##     60        0.8340             nan     0.1000    0.0070
##     80        0.7562             nan     0.1000    0.0044
##    100        0.6933             nan     0.1000    0.0042
##    120        0.6405             nan     0.1000    0.0028
##    140        0.5941             nan     0.1000    0.0040
##    150        0.5750             nan     0.1000    0.0019
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1851
##      2        1.4898             nan     0.1000    0.1319
##      3        1.4062             nan     0.1000    0.1017
##      4        1.3401             nan     0.1000    0.0881
##      5        1.2840             nan     0.1000    0.0783
##      6        1.2343             nan     0.1000    0.0579
##      7        1.1968             nan     0.1000    0.0536
##      8        1.1626             nan     0.1000    0.0545
##      9        1.1279             nan     0.1000    0.0523
##     10        1.0953             nan     0.1000    0.0432
##     20        0.8883             nan     0.1000    0.0204
##     40        0.6721             nan     0.1000    0.0109
##     60        0.5309             nan     0.1000    0.0088
##     80        0.4226             nan     0.1000    0.0056
##    100        0.3461             nan     0.1000    0.0053
##    120        0.2968             nan     0.1000    0.0027
##    140        0.2529             nan     0.1000    0.0040
##    150        0.2341             nan     0.1000    0.0024
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2266
##      2        1.4629             nan     0.1000    0.1637
##      3        1.3600             nan     0.1000    0.1258
##      4        1.2814             nan     0.1000    0.1051
##      5        1.2146             nan     0.1000    0.0930
##      6        1.1580             nan     0.1000    0.0689
##      7        1.1140             nan     0.1000    0.0839
##      8        1.0623             nan     0.1000    0.0632
##      9        1.0228             nan     0.1000    0.0550
##     10        0.9884             nan     0.1000    0.0534
##     20        0.7424             nan     0.1000    0.0254
##     40        0.4922             nan     0.1000    0.0129
##     60        0.3481             nan     0.1000    0.0075
##     80        0.2638             nan     0.1000    0.0042
##    100        0.2037             nan     0.1000    0.0037
##    120        0.1614             nan     0.1000    0.0026
##    140        0.1295             nan     0.1000    0.0020
##    150        0.1176             nan     0.1000    0.0014
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1271
##      2        1.5248             nan     0.1000    0.0863
##      3        1.4682             nan     0.1000    0.0703
##      4        1.4232             nan     0.1000    0.0521
##      5        1.3894             nan     0.1000    0.0464
##      6        1.3592             nan     0.1000    0.0438
##      7        1.3321             nan     0.1000    0.0378
##      8        1.3077             nan     0.1000    0.0370
##      9        1.2831             nan     0.1000    0.0317
##     10        1.2624             nan     0.1000    0.0325
##     20        1.1070             nan     0.1000    0.0175
##     40        0.9367             nan     0.1000    0.0098
##     60        0.8330             nan     0.1000    0.0064
##     80        0.7574             nan     0.1000    0.0049
##    100        0.6956             nan     0.1000    0.0033
##    120        0.6440             nan     0.1000    0.0030
##    140        0.5986             nan     0.1000    0.0032
##    150        0.5769             nan     0.1000    0.0030
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1784
##      2        1.4930             nan     0.1000    0.1253
##      3        1.4113             nan     0.1000    0.1099
##      4        1.3408             nan     0.1000    0.0833
##      5        1.2872             nan     0.1000    0.0733
##      6        1.2408             nan     0.1000    0.0625
##      7        1.2018             nan     0.1000    0.0549
##      8        1.1666             nan     0.1000    0.0461
##      9        1.1362             nan     0.1000    0.0503
##     10        1.1053             nan     0.1000    0.0438
##     20        0.8882             nan     0.1000    0.0237
##     40        0.6657             nan     0.1000    0.0099
##     60        0.5255             nan     0.1000    0.0092
##     80        0.4188             nan     0.1000    0.0057
##    100        0.3432             nan     0.1000    0.0038
##    120        0.2859             nan     0.1000    0.0052
##    140        0.2411             nan     0.1000    0.0050
##    150        0.2192             nan     0.1000    0.0035
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2309
##      2        1.4648             nan     0.1000    0.1610
##      3        1.3636             nan     0.1000    0.1240
##      4        1.2841             nan     0.1000    0.1107
##      5        1.2141             nan     0.1000    0.0798
##      6        1.1634             nan     0.1000    0.0795
##      7        1.1145             nan     0.1000    0.0713
##      8        1.0700             nan     0.1000    0.0722
##      9        1.0251             nan     0.1000    0.0667
##     10        0.9852             nan     0.1000    0.0571
##     20        0.7402             nan     0.1000    0.0372
##     40        0.4868             nan     0.1000    0.0164
##     60        0.3490             nan     0.1000    0.0074
##     80        0.2622             nan     0.1000    0.0034
##    100        0.2012             nan     0.1000    0.0042
##    120        0.1570             nan     0.1000    0.0026
##    140        0.1246             nan     0.1000    0.0023
##    150        0.1132             nan     0.1000    0.0017
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1302
##      2        1.5223             nan     0.1000    0.0878
##      3        1.4645             nan     0.1000    0.0695
##      4        1.4196             nan     0.1000    0.0549
##      5        1.3834             nan     0.1000    0.0434
##      6        1.3542             nan     0.1000    0.0442
##      7        1.3260             nan     0.1000    0.0342
##      8        1.3042             nan     0.1000    0.0343
##      9        1.2825             nan     0.1000    0.0335
##     10        1.2595             nan     0.1000    0.0314
##     20        1.1051             nan     0.1000    0.0210
##     40        0.9352             nan     0.1000    0.0095
##     60        0.8346             nan     0.1000    0.0062
##     80        0.7604             nan     0.1000    0.0061
##    100        0.6961             nan     0.1000    0.0054
##    120        0.6401             nan     0.1000    0.0033
##    140        0.5938             nan     0.1000    0.0025
##    150        0.5755             nan     0.1000    0.0026
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1844
##      2        1.4908             nan     0.1000    0.1328
##      3        1.4053             nan     0.1000    0.0999
##      4        1.3409             nan     0.1000    0.0847
##      5        1.2869             nan     0.1000    0.0713
##      6        1.2409             nan     0.1000    0.0585
##      7        1.2032             nan     0.1000    0.0518
##      8        1.1691             nan     0.1000    0.0585
##      9        1.1327             nan     0.1000    0.0482
##     10        1.1019             nan     0.1000    0.0385
##     20        0.8892             nan     0.1000    0.0195
##     40        0.6717             nan     0.1000    0.0145
##     60        0.5254             nan     0.1000    0.0050
##     80        0.4224             nan     0.1000    0.0046
##    100        0.3470             nan     0.1000    0.0047
##    120        0.2885             nan     0.1000    0.0017
##    140        0.2425             nan     0.1000    0.0041
##    150        0.2213             nan     0.1000    0.0023
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2301
##      2        1.4645             nan     0.1000    0.1621
##      3        1.3604             nan     0.1000    0.1245
##      4        1.2819             nan     0.1000    0.0960
##      5        1.2216             nan     0.1000    0.0877
##      6        1.1660             nan     0.1000    0.0842
##      7        1.1126             nan     0.1000    0.0771
##      8        1.0657             nan     0.1000    0.0654
##      9        1.0251             nan     0.1000    0.0573
##     10        0.9890             nan     0.1000    0.0610
##     20        0.7352             nan     0.1000    0.0296
##     40        0.4878             nan     0.1000    0.0069
##     60        0.3558             nan     0.1000    0.0066
##     80        0.2708             nan     0.1000    0.0055
##    100        0.2093             nan     0.1000    0.0031
##    120        0.1655             nan     0.1000    0.0031
##    140        0.1335             nan     0.1000    0.0026
##    150        0.1194             nan     0.1000    0.0018
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1309
##      2        1.5229             nan     0.1000    0.0858
##      3        1.4663             nan     0.1000    0.0697
##      4        1.4207             nan     0.1000    0.0550
##      5        1.3855             nan     0.1000    0.0517
##      6        1.3521             nan     0.1000    0.0382
##      7        1.3266             nan     0.1000    0.0387
##      8        1.3022             nan     0.1000    0.0350
##      9        1.2799             nan     0.1000    0.0353
##     10        1.2552             nan     0.1000    0.0315
##     20        1.1009             nan     0.1000    0.0182
##     40        0.9286             nan     0.1000    0.0091
##     60        0.8252             nan     0.1000    0.0063
##     80        0.7492             nan     0.1000    0.0045
##    100        0.6882             nan     0.1000    0.0036
##    120        0.6346             nan     0.1000    0.0027
##    140        0.5895             nan     0.1000    0.0033
##    150        0.5696             nan     0.1000    0.0035
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1840
##      2        1.4902             nan     0.1000    0.1366
##      3        1.4029             nan     0.1000    0.0991
##      4        1.3389             nan     0.1000    0.0861
##      5        1.2831             nan     0.1000    0.0720
##      6        1.2356             nan     0.1000    0.0534
##      7        1.1990             nan     0.1000    0.0621
##      8        1.1594             nan     0.1000    0.0485
##      9        1.1280             nan     0.1000    0.0423
##     10        1.1006             nan     0.1000    0.0427
##     20        0.8757             nan     0.1000    0.0228
##     40        0.6522             nan     0.1000    0.0179
##     60        0.5145             nan     0.1000    0.0061
##     80        0.4115             nan     0.1000    0.0086
##    100        0.3437             nan     0.1000    0.0040
##    120        0.2851             nan     0.1000    0.0018
##    140        0.2410             nan     0.1000    0.0028
##    150        0.2229             nan     0.1000    0.0026
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2252
##      2        1.4664             nan     0.1000    0.1650
##      3        1.3609             nan     0.1000    0.1263
##      4        1.2810             nan     0.1000    0.1054
##      5        1.2152             nan     0.1000    0.0940
##      6        1.1562             nan     0.1000    0.0913
##      7        1.1000             nan     0.1000    0.0657
##      8        1.0578             nan     0.1000    0.0596
##      9        1.0205             nan     0.1000    0.0648
##     10        0.9796             nan     0.1000    0.0618
##     20        0.7251             nan     0.1000    0.0325
##     40        0.4879             nan     0.1000    0.0160
##     60        0.3487             nan     0.1000    0.0100
##     80        0.2593             nan     0.1000    0.0074
##    100        0.1977             nan     0.1000    0.0031
##    120        0.1551             nan     0.1000    0.0048
##    140        0.1234             nan     0.1000    0.0019
##    150        0.1123             nan     0.1000    0.0014
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1278
##      2        1.5240             nan     0.1000    0.0888
##      3        1.4660             nan     0.1000    0.0652
##      4        1.4228             nan     0.1000    0.0521
##      5        1.3882             nan     0.1000    0.0507
##      6        1.3557             nan     0.1000    0.0410
##      7        1.3281             nan     0.1000    0.0364
##      8        1.3050             nan     0.1000    0.0371
##      9        1.2796             nan     0.1000    0.0347
##     10        1.2580             nan     0.1000    0.0270
##     20        1.1079             nan     0.1000    0.0169
##     40        0.9380             nan     0.1000    0.0083
##     60        0.8348             nan     0.1000    0.0057
##     80        0.7580             nan     0.1000    0.0051
##    100        0.6965             nan     0.1000    0.0042
##    120        0.6431             nan     0.1000    0.0039
##    140        0.5965             nan     0.1000    0.0029
##    150        0.5739             nan     0.1000    0.0022
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1783
##      2        1.4925             nan     0.1000    0.1342
##      3        1.4057             nan     0.1000    0.1019
##      4        1.3396             nan     0.1000    0.0830
##      5        1.2857             nan     0.1000    0.0661
##      6        1.2422             nan     0.1000    0.0639
##      7        1.2015             nan     0.1000    0.0589
##      8        1.1629             nan     0.1000    0.0451
##      9        1.1334             nan     0.1000    0.0456
##     10        1.1048             nan     0.1000    0.0435
##     20        0.8876             nan     0.1000    0.0206
##     40        0.6668             nan     0.1000    0.0120
##     60        0.5187             nan     0.1000    0.0099
##     80        0.4198             nan     0.1000    0.0049
##    100        0.3458             nan     0.1000    0.0043
##    120        0.2925             nan     0.1000    0.0042
##    140        0.2448             nan     0.1000    0.0030
##    150        0.2278             nan     0.1000    0.0012
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2227
##      2        1.4644             nan     0.1000    0.1602
##      3        1.3631             nan     0.1000    0.1220
##      4        1.2841             nan     0.1000    0.1108
##      5        1.2142             nan     0.1000    0.1111
##      6        1.1453             nan     0.1000    0.0734
##      7        1.0986             nan     0.1000    0.0738
##      8        1.0526             nan     0.1000    0.0652
##      9        1.0129             nan     0.1000    0.0497
##     10        0.9814             nan     0.1000    0.0600
##     20        0.7254             nan     0.1000    0.0262
##     40        0.4946             nan     0.1000    0.0186
##     60        0.3417             nan     0.1000    0.0105
##     80        0.2576             nan     0.1000    0.0054
##    100        0.1976             nan     0.1000    0.0026
##    120        0.1569             nan     0.1000    0.0027
##    140        0.1258             nan     0.1000    0.0015
##    150        0.1117             nan     0.1000    0.0038
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1243
##      2        1.5255             nan     0.1000    0.0851
##      3        1.4691             nan     0.1000    0.0658
##      4        1.4261             nan     0.1000    0.0514
##      5        1.3928             nan     0.1000    0.0429
##      6        1.3646             nan     0.1000    0.0412
##      7        1.3379             nan     0.1000    0.0357
##      8        1.3155             nan     0.1000    0.0382
##      9        1.2896             nan     0.1000    0.0308
##     10        1.2686             nan     0.1000    0.0288
##     20        1.1103             nan     0.1000    0.0201
##     40        0.9400             nan     0.1000    0.0102
##     60        0.8357             nan     0.1000    0.0062
##     80        0.7591             nan     0.1000    0.0038
##    100        0.6957             nan     0.1000    0.0044
##    120        0.6445             nan     0.1000    0.0027
##    140        0.5992             nan     0.1000    0.0020
##    150        0.5803             nan     0.1000    0.0033
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1841
##      2        1.4910             nan     0.1000    0.1248
##      3        1.4109             nan     0.1000    0.1040
##      4        1.3451             nan     0.1000    0.0852
##      5        1.2901             nan     0.1000    0.0742
##      6        1.2426             nan     0.1000    0.0590
##      7        1.2036             nan     0.1000    0.0611
##      8        1.1652             nan     0.1000    0.0454
##      9        1.1353             nan     0.1000    0.0498
##     10        1.1048             nan     0.1000    0.0488
##     20        0.8812             nan     0.1000    0.0242
##     40        0.6706             nan     0.1000    0.0152
##     60        0.5272             nan     0.1000    0.0158
##     80        0.4205             nan     0.1000    0.0039
##    100        0.3472             nan     0.1000    0.0047
##    120        0.2903             nan     0.1000    0.0022
##    140        0.2438             nan     0.1000    0.0019
##    150        0.2273             nan     0.1000    0.0029
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2245
##      2        1.4667             nan     0.1000    0.1604
##      3        1.3647             nan     0.1000    0.1249
##      4        1.2859             nan     0.1000    0.1026
##      5        1.2201             nan     0.1000    0.0814
##      6        1.1670             nan     0.1000    0.0844
##      7        1.1144             nan     0.1000    0.0697
##      8        1.0709             nan     0.1000    0.0629
##      9        1.0310             nan     0.1000    0.0625
##     10        0.9923             nan     0.1000    0.0615
##     20        0.7530             nan     0.1000    0.0319
##     40        0.4893             nan     0.1000    0.0151
##     60        0.3478             nan     0.1000    0.0087
##     80        0.2590             nan     0.1000    0.0054
##    100        0.2017             nan     0.1000    0.0029
##    120        0.1601             nan     0.1000    0.0040
##    140        0.1269             nan     0.1000    0.0024
##    150        0.1147             nan     0.1000    0.0019
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1278
##      2        1.5250             nan     0.1000    0.0920
##      3        1.4653             nan     0.1000    0.0672
##      4        1.4210             nan     0.1000    0.0542
##      5        1.3858             nan     0.1000    0.0431
##      6        1.3575             nan     0.1000    0.0463
##      7        1.3278             nan     0.1000    0.0376
##      8        1.3043             nan     0.1000    0.0384
##      9        1.2783             nan     0.1000    0.0308
##     10        1.2581             nan     0.1000    0.0299
##     20        1.0993             nan     0.1000    0.0199
##     40        0.9311             nan     0.1000    0.0092
##     60        0.8260             nan     0.1000    0.0060
##     80        0.7490             nan     0.1000    0.0056
##    100        0.6879             nan     0.1000    0.0043
##    120        0.6353             nan     0.1000    0.0038
##    140        0.5905             nan     0.1000    0.0041
##    150        0.5704             nan     0.1000    0.0021
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1840
##      2        1.4900             nan     0.1000    0.1298
##      3        1.4059             nan     0.1000    0.1012
##      4        1.3406             nan     0.1000    0.0848
##      5        1.2864             nan     0.1000    0.0692
##      6        1.2412             nan     0.1000    0.0621
##      7        1.2022             nan     0.1000    0.0528
##      8        1.1673             nan     0.1000    0.0542
##      9        1.1330             nan     0.1000    0.0404
##     10        1.1070             nan     0.1000    0.0482
##     20        0.8817             nan     0.1000    0.0243
##     40        0.6633             nan     0.1000    0.0088
##     60        0.5306             nan     0.1000    0.0126
##     80        0.4293             nan     0.1000    0.0101
##    100        0.3502             nan     0.1000    0.0058
##    120        0.2913             nan     0.1000    0.0068
##    140        0.2450             nan     0.1000    0.0034
##    150        0.2264             nan     0.1000    0.0024
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2316
##      2        1.4623             nan     0.1000    0.1514
##      3        1.3667             nan     0.1000    0.1492
##      4        1.2744             nan     0.1000    0.0978
##      5        1.2108             nan     0.1000    0.0939
##      6        1.1512             nan     0.1000    0.0806
##      7        1.1014             nan     0.1000    0.0867
##      8        1.0492             nan     0.1000    0.0557
##      9        1.0142             nan     0.1000    0.0595
##     10        0.9761             nan     0.1000    0.0670
##     20        0.7293             nan     0.1000    0.0260
##     40        0.4804             nan     0.1000    0.0124
##     60        0.3360             nan     0.1000    0.0051
##     80        0.2541             nan     0.1000    0.0068
##    100        0.1973             nan     0.1000    0.0041
##    120        0.1561             nan     0.1000    0.0024
##    140        0.1275             nan     0.1000    0.0009
##    150        0.1143             nan     0.1000    0.0009
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1280
##      2        1.5259             nan     0.1000    0.0873
##      3        1.4691             nan     0.1000    0.0649
##      4        1.4262             nan     0.1000    0.0530
##      5        1.3916             nan     0.1000    0.0507
##      6        1.3588             nan     0.1000    0.0388
##      7        1.3338             nan     0.1000    0.0405
##      8        1.3086             nan     0.1000    0.0359
##      9        1.2845             nan     0.1000    0.0335
##     10        1.2632             nan     0.1000    0.0269
##     20        1.1061             nan     0.1000    0.0192
##     40        0.9361             nan     0.1000    0.0092
##     60        0.8339             nan     0.1000    0.0059
##     80        0.7600             nan     0.1000    0.0049
##    100        0.6973             nan     0.1000    0.0051
##    120        0.6447             nan     0.1000    0.0035
##    140        0.5987             nan     0.1000    0.0029
##    150        0.5784             nan     0.1000    0.0029
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1813
##      2        1.4912             nan     0.1000    0.1331
##      3        1.4062             nan     0.1000    0.1010
##      4        1.3410             nan     0.1000    0.0859
##      5        1.2861             nan     0.1000    0.0645
##      6        1.2435             nan     0.1000    0.0615
##      7        1.2043             nan     0.1000    0.0602
##      8        1.1666             nan     0.1000    0.0510
##      9        1.1339             nan     0.1000    0.0556
##     10        1.0998             nan     0.1000    0.0518
##     20        0.8825             nan     0.1000    0.0190
##     40        0.6697             nan     0.1000    0.0159
##     60        0.5314             nan     0.1000    0.0117
##     80        0.4223             nan     0.1000    0.0090
##    100        0.3443             nan     0.1000    0.0041
##    120        0.2860             nan     0.1000    0.0034
##    140        0.2430             nan     0.1000    0.0030
##    150        0.2260             nan     0.1000    0.0031
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2318
##      2        1.4646             nan     0.1000    0.1634
##      3        1.3615             nan     0.1000    0.1300
##      4        1.2799             nan     0.1000    0.1046
##      5        1.2130             nan     0.1000    0.0930
##      6        1.1564             nan     0.1000    0.0727
##      7        1.1095             nan     0.1000    0.0736
##      8        1.0630             nan     0.1000    0.0615
##      9        1.0235             nan     0.1000    0.0780
##     10        0.9773             nan     0.1000    0.0503
##     20        0.7229             nan     0.1000    0.0366
##     40        0.4816             nan     0.1000    0.0101
##     60        0.3498             nan     0.1000    0.0053
##     80        0.2614             nan     0.1000    0.0055
##    100        0.2012             nan     0.1000    0.0057
##    120        0.1627             nan     0.1000    0.0037
##    140        0.1292             nan     0.1000    0.0020
##    150        0.1169             nan     0.1000    0.0031
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1291
##      2        1.5222             nan     0.1000    0.0894
##      3        1.4626             nan     0.1000    0.0674
##      4        1.4181             nan     0.1000    0.0586
##      5        1.3810             nan     0.1000    0.0444
##      6        1.3514             nan     0.1000    0.0466
##      7        1.3231             nan     0.1000    0.0374
##      8        1.2989             nan     0.1000    0.0335
##      9        1.2779             nan     0.1000    0.0297
##     10        1.2591             nan     0.1000    0.0344
##     20        1.0992             nan     0.1000    0.0177
##     40        0.9297             nan     0.1000    0.0095
##     60        0.8285             nan     0.1000    0.0068
##     80        0.7520             nan     0.1000    0.0044
##    100        0.6907             nan     0.1000    0.0032
##    120        0.6385             nan     0.1000    0.0043
##    140        0.5937             nan     0.1000    0.0041
##    150        0.5731             nan     0.1000    0.0032
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1831
##      2        1.4885             nan     0.1000    0.1271
##      3        1.4059             nan     0.1000    0.1046
##      4        1.3398             nan     0.1000    0.0890
##      5        1.2830             nan     0.1000    0.0754
##      6        1.2355             nan     0.1000    0.0569
##      7        1.1972             nan     0.1000    0.0588
##      8        1.1602             nan     0.1000    0.0553
##      9        1.1250             nan     0.1000    0.0444
##     10        1.0977             nan     0.1000    0.0394
##     20        0.8793             nan     0.1000    0.0269
##     40        0.6645             nan     0.1000    0.0118
##     60        0.5203             nan     0.1000    0.0126
##     80        0.4225             nan     0.1000    0.0140
##    100        0.3383             nan     0.1000    0.0047
##    120        0.2814             nan     0.1000    0.0022
##    140        0.2413             nan     0.1000    0.0014
##    150        0.2213             nan     0.1000    0.0017
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2334
##      2        1.4621             nan     0.1000    0.1679
##      3        1.3570             nan     0.1000    0.1261
##      4        1.2792             nan     0.1000    0.1075
##      5        1.2119             nan     0.1000    0.0812
##      6        1.1602             nan     0.1000    0.0923
##      7        1.1046             nan     0.1000    0.0717
##      8        1.0606             nan     0.1000    0.0615
##      9        1.0213             nan     0.1000    0.0712
##     10        0.9786             nan     0.1000    0.0526
##     20        0.7311             nan     0.1000    0.0199
##     40        0.4864             nan     0.1000    0.0120
##     60        0.3496             nan     0.1000    0.0072
##     80        0.2563             nan     0.1000    0.0069
##    100        0.1986             nan     0.1000    0.0059
##    120        0.1557             nan     0.1000    0.0019
##    140        0.1239             nan     0.1000    0.0016
##    150        0.1107             nan     0.1000    0.0014
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1277
##      2        1.5242             nan     0.1000    0.0892
##      3        1.4662             nan     0.1000    0.0694
##      4        1.4214             nan     0.1000    0.0545
##      5        1.3853             nan     0.1000    0.0439
##      6        1.3571             nan     0.1000    0.0433
##      7        1.3297             nan     0.1000    0.0396
##      8        1.3050             nan     0.1000    0.0406
##      9        1.2785             nan     0.1000    0.0317
##     10        1.2577             nan     0.1000    0.0288
##     20        1.1056             nan     0.1000    0.0166
##     40        0.9390             nan     0.1000    0.0091
##     60        0.8369             nan     0.1000    0.0068
##     80        0.7598             nan     0.1000    0.0041
##    100        0.6989             nan     0.1000    0.0040
##    120        0.6472             nan     0.1000    0.0033
##    140        0.6005             nan     0.1000    0.0048
##    150        0.5789             nan     0.1000    0.0028
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1865
##      2        1.4881             nan     0.1000    0.1337
##      3        1.4028             nan     0.1000    0.1015
##      4        1.3382             nan     0.1000    0.0845
##      5        1.2836             nan     0.1000    0.0725
##      6        1.2379             nan     0.1000    0.0624
##      7        1.1983             nan     0.1000    0.0586
##      8        1.1617             nan     0.1000    0.0534
##      9        1.1284             nan     0.1000    0.0402
##     10        1.1028             nan     0.1000    0.0390
##     20        0.8879             nan     0.1000    0.0241
##     40        0.6793             nan     0.1000    0.0142
##     60        0.5323             nan     0.1000    0.0063
##     80        0.4285             nan     0.1000    0.0079
##    100        0.3500             nan     0.1000    0.0026
##    120        0.2899             nan     0.1000    0.0021
##    140        0.2479             nan     0.1000    0.0033
##    150        0.2283             nan     0.1000    0.0026
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2318
##      2        1.4625             nan     0.1000    0.1634
##      3        1.3594             nan     0.1000    0.1198
##      4        1.2823             nan     0.1000    0.1009
##      5        1.2186             nan     0.1000    0.0938
##      6        1.1606             nan     0.1000    0.0726
##      7        1.1147             nan     0.1000    0.0681
##      8        1.0724             nan     0.1000    0.0568
##      9        1.0368             nan     0.1000    0.0566
##     10        1.0017             nan     0.1000    0.0565
##     20        0.7428             nan     0.1000    0.0273
##     40        0.4966             nan     0.1000    0.0118
##     60        0.3486             nan     0.1000    0.0078
##     80        0.2628             nan     0.1000    0.0024
##    100        0.2034             nan     0.1000    0.0023
##    120        0.1617             nan     0.1000    0.0023
##    140        0.1311             nan     0.1000    0.0018
##    150        0.1163             nan     0.1000    0.0018
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1276
##      2        1.5248             nan     0.1000    0.0851
##      3        1.4690             nan     0.1000    0.0643
##      4        1.4266             nan     0.1000    0.0539
##      5        1.3914             nan     0.1000    0.0505
##      6        1.3593             nan     0.1000    0.0386
##      7        1.3348             nan     0.1000    0.0380
##      8        1.3108             nan     0.1000    0.0353
##      9        1.2884             nan     0.1000    0.0348
##     10        1.2650             nan     0.1000    0.0259
##     20        1.1124             nan     0.1000    0.0198
##     40        0.9403             nan     0.1000    0.0086
##     60        0.8391             nan     0.1000    0.0055
##     80        0.7636             nan     0.1000    0.0044
##    100        0.7006             nan     0.1000    0.0043
##    120        0.6479             nan     0.1000    0.0034
##    140        0.6025             nan     0.1000    0.0026
##    150        0.5817             nan     0.1000    0.0025
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1809
##      2        1.4912             nan     0.1000    0.1283
##      3        1.4085             nan     0.1000    0.1047
##      4        1.3421             nan     0.1000    0.0848
##      5        1.2873             nan     0.1000    0.0673
##      6        1.2435             nan     0.1000    0.0617
##      7        1.2042             nan     0.1000    0.0568
##      8        1.1685             nan     0.1000    0.0497
##      9        1.1373             nan     0.1000    0.0523
##     10        1.1048             nan     0.1000    0.0400
##     20        0.8953             nan     0.1000    0.0212
##     40        0.6775             nan     0.1000    0.0190
##     60        0.5281             nan     0.1000    0.0070
##     80        0.4175             nan     0.1000    0.0073
##    100        0.3420             nan     0.1000    0.0038
##    120        0.2860             nan     0.1000    0.0036
##    140        0.2408             nan     0.1000    0.0041
##    150        0.2217             nan     0.1000    0.0018
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2234
##      2        1.4652             nan     0.1000    0.1651
##      3        1.3610             nan     0.1000    0.1205
##      4        1.2836             nan     0.1000    0.0967
##      5        1.2214             nan     0.1000    0.0883
##      6        1.1642             nan     0.1000    0.0734
##      7        1.1165             nan     0.1000    0.0969
##      8        1.0572             nan     0.1000    0.0616
##      9        1.0187             nan     0.1000    0.0521
##     10        0.9859             nan     0.1000    0.0460
##     20        0.7298             nan     0.1000    0.0228
##     40        0.4813             nan     0.1000    0.0155
##     60        0.3397             nan     0.1000    0.0071
##     80        0.2600             nan     0.1000    0.0063
##    100        0.1963             nan     0.1000    0.0025
##    120        0.1542             nan     0.1000    0.0027
##    140        0.1243             nan     0.1000    0.0015
##    150        0.1110             nan     0.1000    0.0012
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1284
##      2        1.5230             nan     0.1000    0.0866
##      3        1.4653             nan     0.1000    0.0667
##      4        1.4213             nan     0.1000    0.0535
##      5        1.3861             nan     0.1000    0.0484
##      6        1.3547             nan     0.1000    0.0395
##      7        1.3291             nan     0.1000    0.0312
##      8        1.3079             nan     0.1000    0.0366
##      9        1.2831             nan     0.1000    0.0345
##     10        1.2615             nan     0.1000    0.0322
##     20        1.1035             nan     0.1000    0.0174
##     40        0.9337             nan     0.1000    0.0085
##     60        0.8313             nan     0.1000    0.0068
##     80        0.7528             nan     0.1000    0.0040
##    100        0.6897             nan     0.1000    0.0030
##    120        0.6379             nan     0.1000    0.0028
##    140        0.5933             nan     0.1000    0.0023
##    150        0.5749             nan     0.1000    0.0027
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1883
##      2        1.4883             nan     0.1000    0.1362
##      3        1.4013             nan     0.1000    0.0987
##      4        1.3375             nan     0.1000    0.0862
##      5        1.2824             nan     0.1000    0.0713
##      6        1.2360             nan     0.1000    0.0588
##      7        1.1967             nan     0.1000    0.0602
##      8        1.1589             nan     0.1000    0.0454
##      9        1.1302             nan     0.1000    0.0468
##     10        1.1003             nan     0.1000    0.0457
##     20        0.8816             nan     0.1000    0.0232
##     40        0.6659             nan     0.1000    0.0124
##     60        0.5268             nan     0.1000    0.0097
##     80        0.4228             nan     0.1000    0.0062
##    100        0.3508             nan     0.1000    0.0035
##    120        0.2929             nan     0.1000    0.0031
##    140        0.2500             nan     0.1000    0.0038
##    150        0.2337             nan     0.1000    0.0023
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2303
##      2        1.4630             nan     0.1000    0.1697
##      3        1.3551             nan     0.1000    0.1211
##      4        1.2783             nan     0.1000    0.1014
##      5        1.2127             nan     0.1000    0.0819
##      6        1.1602             nan     0.1000    0.0755
##      7        1.1118             nan     0.1000    0.0660
##      8        1.0711             nan     0.1000    0.0606
##      9        1.0338             nan     0.1000    0.0724
##     10        0.9899             nan     0.1000    0.0539
##     20        0.7230             nan     0.1000    0.0334
##     40        0.4789             nan     0.1000    0.0123
##     60        0.3476             nan     0.1000    0.0077
##     80        0.2679             nan     0.1000    0.0049
##    100        0.2075             nan     0.1000    0.0040
##    120        0.1599             nan     0.1000    0.0025
##    140        0.1289             nan     0.1000    0.0026
##    150        0.1162             nan     0.1000    0.0027
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1279
##      2        1.5235             nan     0.1000    0.0889
##      3        1.4648             nan     0.1000    0.0651
##      4        1.4215             nan     0.1000    0.0546
##      5        1.3863             nan     0.1000    0.0436
##      6        1.3573             nan     0.1000    0.0469
##      7        1.3281             nan     0.1000    0.0385
##      8        1.3038             nan     0.1000    0.0368
##      9        1.2801             nan     0.1000    0.0343
##     10        1.2569             nan     0.1000    0.0264
##     20        1.1024             nan     0.1000    0.0149
##     40        0.9341             nan     0.1000    0.0099
##     60        0.8293             nan     0.1000    0.0062
##     80        0.7535             nan     0.1000    0.0054
##    100        0.6905             nan     0.1000    0.0037
##    120        0.6365             nan     0.1000    0.0029
##    140        0.5946             nan     0.1000    0.0026
##    150        0.5750             nan     0.1000    0.0034
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1827
##      2        1.4898             nan     0.1000    0.1294
##      3        1.4068             nan     0.1000    0.0999
##      4        1.3412             nan     0.1000    0.0888
##      5        1.2844             nan     0.1000    0.0733
##      6        1.2379             nan     0.1000    0.0632
##      7        1.1975             nan     0.1000    0.0618
##      8        1.1592             nan     0.1000    0.0483
##      9        1.1286             nan     0.1000    0.0432
##     10        1.1016             nan     0.1000    0.0425
##     20        0.8861             nan     0.1000    0.0209
##     40        0.6694             nan     0.1000    0.0110
##     60        0.5280             nan     0.1000    0.0115
##     80        0.4237             nan     0.1000    0.0048
##    100        0.3457             nan     0.1000    0.0040
##    120        0.2915             nan     0.1000    0.0041
##    140        0.2483             nan     0.1000    0.0028
##    150        0.2298             nan     0.1000    0.0030
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2292
##      2        1.4618             nan     0.1000    0.1571
##      3        1.3630             nan     0.1000    0.1314
##      4        1.2796             nan     0.1000    0.1214
##      5        1.2064             nan     0.1000    0.0840
##      6        1.1523             nan     0.1000    0.0890
##      7        1.0974             nan     0.1000    0.0670
##      8        1.0548             nan     0.1000    0.0663
##      9        1.0134             nan     0.1000    0.0581
##     10        0.9779             nan     0.1000    0.0542
##     20        0.7251             nan     0.1000    0.0236
##     40        0.4790             nan     0.1000    0.0199
##     60        0.3431             nan     0.1000    0.0109
##     80        0.2546             nan     0.1000    0.0059
##    100        0.1959             nan     0.1000    0.0024
##    120        0.1563             nan     0.1000    0.0036
##    140        0.1272             nan     0.1000    0.0016
##    150        0.1152             nan     0.1000    0.0024
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1289
##      2        1.5226             nan     0.1000    0.0865
##      3        1.4659             nan     0.1000    0.0661
##      4        1.4225             nan     0.1000    0.0536
##      5        1.3872             nan     0.1000    0.0410
##      6        1.3600             nan     0.1000    0.0466
##      7        1.3304             nan     0.1000    0.0347
##      8        1.3077             nan     0.1000    0.0338
##      9        1.2851             nan     0.1000    0.0329
##     10        1.2646             nan     0.1000    0.0295
##     20        1.1095             nan     0.1000    0.0184
##     40        0.9413             nan     0.1000    0.0077
##     60        0.8384             nan     0.1000    0.0061
##     80        0.7617             nan     0.1000    0.0049
##    100        0.6979             nan     0.1000    0.0034
##    120        0.6454             nan     0.1000    0.0041
##    140        0.5981             nan     0.1000    0.0034
##    150        0.5771             nan     0.1000    0.0024
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1839
##      2        1.4913             nan     0.1000    0.1236
##      3        1.4099             nan     0.1000    0.1080
##      4        1.3414             nan     0.1000    0.0852
##      5        1.2869             nan     0.1000    0.0673
##      6        1.2430             nan     0.1000    0.0617
##      7        1.2036             nan     0.1000    0.0565
##      8        1.1667             nan     0.1000    0.0547
##      9        1.1329             nan     0.1000    0.0434
##     10        1.1056             nan     0.1000    0.0471
##     20        0.8920             nan     0.1000    0.0217
##     40        0.6764             nan     0.1000    0.0175
##     60        0.5216             nan     0.1000    0.0093
##     80        0.4204             nan     0.1000    0.0123
##    100        0.3406             nan     0.1000    0.0038
##    120        0.2862             nan     0.1000    0.0034
##    140        0.2419             nan     0.1000    0.0029
##    150        0.2225             nan     0.1000    0.0028
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2218
##      2        1.4657             nan     0.1000    0.1619
##      3        1.3647             nan     0.1000    0.1201
##      4        1.2881             nan     0.1000    0.1055
##      5        1.2209             nan     0.1000    0.0861
##      6        1.1666             nan     0.1000    0.0883
##      7        1.1140             nan     0.1000    0.0598
##      8        1.0749             nan     0.1000    0.0723
##      9        1.0294             nan     0.1000    0.0647
##     10        0.9896             nan     0.1000    0.0557
##     20        0.7390             nan     0.1000    0.0280
##     40        0.4814             nan     0.1000    0.0121
##     60        0.3388             nan     0.1000    0.0093
##     80        0.2497             nan     0.1000    0.0033
##    100        0.1954             nan     0.1000    0.0029
##    120        0.1551             nan     0.1000    0.0014
##    140        0.1249             nan     0.1000    0.0012
##    150        0.1120             nan     0.1000    0.0012
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1309
##      2        1.5223             nan     0.1000    0.0885
##      3        1.4647             nan     0.1000    0.0651
##      4        1.4213             nan     0.1000    0.0573
##      5        1.3842             nan     0.1000    0.0430
##      6        1.3552             nan     0.1000    0.0443
##      7        1.3269             nan     0.1000    0.0404
##      8        1.3012             nan     0.1000    0.0304
##      9        1.2812             nan     0.1000    0.0372
##     10        1.2561             nan     0.1000    0.0301
##     20        1.0990             nan     0.1000    0.0165
##     40        0.9294             nan     0.1000    0.0083
##     60        0.8275             nan     0.1000    0.0075
##     80        0.7510             nan     0.1000    0.0054
##    100        0.6901             nan     0.1000    0.0031
##    120        0.6387             nan     0.1000    0.0031
##    140        0.5937             nan     0.1000    0.0016
##    150        0.5737             nan     0.1000    0.0026
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1893
##      2        1.4881             nan     0.1000    0.1305
##      3        1.4034             nan     0.1000    0.1001
##      4        1.3382             nan     0.1000    0.0823
##      5        1.2839             nan     0.1000    0.0776
##      6        1.2356             nan     0.1000    0.0635
##      7        1.1947             nan     0.1000    0.0569
##      8        1.1589             nan     0.1000    0.0503
##      9        1.1277             nan     0.1000    0.0517
##     10        1.0951             nan     0.1000    0.0464
##     20        0.8763             nan     0.1000    0.0352
##     40        0.6532             nan     0.1000    0.0097
##     60        0.5136             nan     0.1000    0.0120
##     80        0.4139             nan     0.1000    0.0047
##    100        0.3401             nan     0.1000    0.0028
##    120        0.2801             nan     0.1000    0.0017
##    140        0.2425             nan     0.1000    0.0022
##    150        0.2228             nan     0.1000    0.0039
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2323
##      2        1.4612             nan     0.1000    0.1697
##      3        1.3544             nan     0.1000    0.1243
##      4        1.2754             nan     0.1000    0.1023
##      5        1.2096             nan     0.1000    0.0922
##      6        1.1515             nan     0.1000    0.0700
##      7        1.1061             nan     0.1000    0.0815
##      8        1.0555             nan     0.1000    0.0492
##      9        1.0237             nan     0.1000    0.0632
##     10        0.9848             nan     0.1000    0.0556
##     20        0.7360             nan     0.1000    0.0290
##     40        0.4744             nan     0.1000    0.0183
##     60        0.3389             nan     0.1000    0.0054
##     80        0.2570             nan     0.1000    0.0043
##    100        0.1998             nan     0.1000    0.0015
##    120        0.1584             nan     0.1000    0.0035
##    140        0.1276             nan     0.1000    0.0013
##    150        0.1174             nan     0.1000    0.0023
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1303
##      2        1.5220             nan     0.1000    0.0855
##      3        1.4648             nan     0.1000    0.0669
##      4        1.4209             nan     0.1000    0.0515
##      5        1.3867             nan     0.1000    0.0418
##      6        1.3586             nan     0.1000    0.0411
##      7        1.3319             nan     0.1000    0.0356
##      8        1.3089             nan     0.1000    0.0358
##      9        1.2866             nan     0.1000    0.0331
##     10        1.2633             nan     0.1000    0.0291
##     20        1.1075             nan     0.1000    0.0183
##     40        0.9375             nan     0.1000    0.0103
##     60        0.8352             nan     0.1000    0.0054
##     80        0.7600             nan     0.1000    0.0047
##    100        0.6974             nan     0.1000    0.0046
##    120        0.6451             nan     0.1000    0.0037
##    140        0.6000             nan     0.1000    0.0031
##    150        0.5789             nan     0.1000    0.0028
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1839
##      2        1.4882             nan     0.1000    0.1238
##      3        1.4084             nan     0.1000    0.1020
##      4        1.3431             nan     0.1000    0.0827
##      5        1.2886             nan     0.1000    0.0714
##      6        1.2422             nan     0.1000    0.0636
##      7        1.2020             nan     0.1000    0.0554
##      8        1.1667             nan     0.1000    0.0524
##      9        1.1328             nan     0.1000    0.0522
##     10        1.1006             nan     0.1000    0.0444
##     20        0.8926             nan     0.1000    0.0215
##     40        0.6683             nan     0.1000    0.0090
##     60        0.5216             nan     0.1000    0.0106
##     80        0.4159             nan     0.1000    0.0039
##    100        0.3448             nan     0.1000    0.0056
##    120        0.2902             nan     0.1000    0.0072
##    140        0.2448             nan     0.1000    0.0022
##    150        0.2257             nan     0.1000    0.0023
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2306
##      2        1.4613             nan     0.1000    0.1566
##      3        1.3609             nan     0.1000    0.1256
##      4        1.2811             nan     0.1000    0.1002
##      5        1.2158             nan     0.1000    0.0842
##      6        1.1621             nan     0.1000    0.0742
##      7        1.1139             nan     0.1000    0.0829
##      8        1.0634             nan     0.1000    0.0519
##      9        1.0300             nan     0.1000    0.0680
##     10        0.9884             nan     0.1000    0.0480
##     20        0.7356             nan     0.1000    0.0268
##     40        0.4979             nan     0.1000    0.0165
##     60        0.3566             nan     0.1000    0.0089
##     80        0.2701             nan     0.1000    0.0077
##    100        0.2090             nan     0.1000    0.0023
##    120        0.1623             nan     0.1000    0.0023
##    140        0.1317             nan     0.1000    0.0012
##    150        0.1179             nan     0.1000    0.0018
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1270
##      2        1.5241             nan     0.1000    0.0864
##      3        1.4668             nan     0.1000    0.0672
##      4        1.4238             nan     0.1000    0.0551
##      5        1.3878             nan     0.1000    0.0488
##      6        1.3569             nan     0.1000    0.0414
##      7        1.3303             nan     0.1000    0.0386
##      8        1.3059             nan     0.1000    0.0337
##      9        1.2839             nan     0.1000    0.0370
##     10        1.2586             nan     0.1000    0.0299
##     20        1.1029             nan     0.1000    0.0182
##     40        0.9309             nan     0.1000    0.0090
##     60        0.8286             nan     0.1000    0.0063
##     80        0.7539             nan     0.1000    0.0055
##    100        0.6911             nan     0.1000    0.0033
##    120        0.6418             nan     0.1000    0.0035
##    140        0.5966             nan     0.1000    0.0021
##    150        0.5750             nan     0.1000    0.0027
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1849
##      2        1.4886             nan     0.1000    0.1326
##      3        1.4042             nan     0.1000    0.1020
##      4        1.3382             nan     0.1000    0.0813
##      5        1.2861             nan     0.1000    0.0741
##      6        1.2390             nan     0.1000    0.0627
##      7        1.1987             nan     0.1000    0.0532
##      8        1.1640             nan     0.1000    0.0518
##      9        1.1312             nan     0.1000    0.0628
##     10        1.0932             nan     0.1000    0.0447
##     20        0.8767             nan     0.1000    0.0243
##     40        0.6577             nan     0.1000    0.0134
##     60        0.5238             nan     0.1000    0.0086
##     80        0.4205             nan     0.1000    0.0078
##    100        0.3449             nan     0.1000    0.0059
##    120        0.2864             nan     0.1000    0.0042
##    140        0.2432             nan     0.1000    0.0043
##    150        0.2219             nan     0.1000    0.0043
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2311
##      2        1.4627             nan     0.1000    0.1645
##      3        1.3607             nan     0.1000    0.1210
##      4        1.2831             nan     0.1000    0.1090
##      5        1.2145             nan     0.1000    0.0891
##      6        1.1586             nan     0.1000    0.0982
##      7        1.0983             nan     0.1000    0.0732
##      8        1.0530             nan     0.1000    0.0681
##      9        1.0119             nan     0.1000    0.0542
##     10        0.9771             nan     0.1000    0.0635
##     20        0.7204             nan     0.1000    0.0282
##     40        0.4928             nan     0.1000    0.0167
##     60        0.3442             nan     0.1000    0.0077
##     80        0.2546             nan     0.1000    0.0038
##    100        0.1986             nan     0.1000    0.0020
##    120        0.1566             nan     0.1000    0.0016
##    140        0.1245             nan     0.1000    0.0033
##    150        0.1120             nan     0.1000    0.0013
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1265
##      2        1.5236             nan     0.1000    0.0833
##      3        1.4672             nan     0.1000    0.0655
##      4        1.4240             nan     0.1000    0.0536
##      5        1.3895             nan     0.1000    0.0491
##      6        1.3578             nan     0.1000    0.0389
##      7        1.3328             nan     0.1000    0.0382
##      8        1.3082             nan     0.1000    0.0283
##      9        1.2899             nan     0.1000    0.0364
##     10        1.2647             nan     0.1000    0.0279
##     20        1.1127             nan     0.1000    0.0156
##     40        0.9430             nan     0.1000    0.0092
##     60        0.8421             nan     0.1000    0.0058
##     80        0.7663             nan     0.1000    0.0040
##    100        0.7051             nan     0.1000    0.0027
##    120        0.6534             nan     0.1000    0.0040
##    140        0.6074             nan     0.1000    0.0024
##    150        0.5863             nan     0.1000    0.0034
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.1830
##      2        1.4920             nan     0.1000    0.1322
##      3        1.4076             nan     0.1000    0.0977
##      4        1.3442             nan     0.1000    0.0808
##      5        1.2930             nan     0.1000    0.0676
##      6        1.2490             nan     0.1000    0.0591
##      7        1.2110             nan     0.1000    0.0594
##      8        1.1726             nan     0.1000    0.0570
##      9        1.1373             nan     0.1000    0.0427
##     10        1.1100             nan     0.1000    0.0429
##     20        0.9071             nan     0.1000    0.0307
##     40        0.6817             nan     0.1000    0.0142
##     60        0.5362             nan     0.1000    0.0164
##     80        0.4359             nan     0.1000    0.0071
##    100        0.3550             nan     0.1000    0.0044
##    120        0.2961             nan     0.1000    0.0045
##    140        0.2502             nan     0.1000    0.0031
##    150        0.2288             nan     0.1000    0.0020
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2250
##      2        1.4653             nan     0.1000    0.1593
##      3        1.3642             nan     0.1000    0.1187
##      4        1.2890             nan     0.1000    0.1101
##      5        1.2194             nan     0.1000    0.0875
##      6        1.1637             nan     0.1000    0.0765
##      7        1.1168             nan     0.1000    0.0589
##      8        1.0791             nan     0.1000    0.0679
##      9        1.0365             nan     0.1000    0.0461
##     10        1.0068             nan     0.1000    0.0516
##     20        0.7529             nan     0.1000    0.0279
##     40        0.4935             nan     0.1000    0.0142
##     60        0.3489             nan     0.1000    0.0098
##     80        0.2628             nan     0.1000    0.0043
##    100        0.2087             nan     0.1000    0.0036
##    120        0.1646             nan     0.1000    0.0015
##    140        0.1332             nan     0.1000    0.0021
##    150        0.1209             nan     0.1000    0.0018
## 
## Iter   TrainDeviance   ValidDeviance   StepSize   Improve
##      1        1.6094             nan     0.1000    0.2270
##      2        1.4641             nan     0.1000    0.1552
##      3        1.3647             nan     0.1000    0.1299
##      4        1.2831             nan     0.1000    0.1038
##      5        1.2173             nan     0.1000    0.0812
##      6        1.1653             nan     0.1000    0.0826
##      7        1.1144             nan     0.1000    0.0826
##      8        1.0622             nan     0.1000    0.0637
##      9        1.0224             nan     0.1000    0.0614
##     10        0.9846             nan     0.1000    0.0489
##     20        0.7319             nan     0.1000    0.0289
##     40        0.4755             nan     0.1000    0.0223
##     60        0.3402             nan     0.1000    0.0093
##     80        0.2587             nan     0.1000    0.0068
##    100        0.1964             nan     0.1000    0.0040
##    120        0.1578             nan     0.1000    0.0034
##    140        0.1264             nan     0.1000    0.0011
##    150        0.1139             nan     0.1000    0.0028
# we have used confusion matrix under CARET package to check out of sample error. out of sample accuracy is 0.9973 with using randomforest. 

confusionMatrix(predict(modelfit_gbm,test_vif),test_vif$test_data.classe)
## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 1110    6    0    0    0
##          B    5  746    6    1    2
##          C    0    4  676   10    2
##          D    1    1    1  632    5
##          E    0    2    1    0  712
## 
## Overall Statistics
##                                           
##                Accuracy : 0.988           
##                  95% CI : (0.9841, 0.9912)
##     No Information Rate : 0.2845          
##     P-Value [Acc > NIR] : < 2.2e-16       
##                                           
##                   Kappa : 0.9848          
##                                           
##  Mcnemar's Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity            0.9946   0.9829   0.9883   0.9829   0.9875
## Specificity            0.9979   0.9956   0.9951   0.9976   0.9991
## Pos Pred Value         0.9946   0.9816   0.9769   0.9875   0.9958
## Neg Pred Value         0.9979   0.9959   0.9975   0.9966   0.9972
## Prevalence             0.2845   0.1935   0.1744   0.1639   0.1838
## Detection Rate         0.2829   0.1902   0.1723   0.1611   0.1815
## Detection Prevalence   0.2845   0.1937   0.1764   0.1631   0.1823
## Balanced Accuracy      0.9962   0.9892   0.9917   0.9902   0.9933


Prediction with using classification method
# Train function under CARET is having  
modelfit_class <- train(train_data.classe ~ ., method="rpart", data=train_vif)
# we have installed rattle package to create fancy tree
fancyRpartPlot(modelfit_class$finalModel)


pred_test <- table(predict(modelfit_class, test_vif), test_vif$test_data.classe)
pred_test
##    
##        A    B    C    D    E
##   A 1017  336  313  280   98
##   B   17  243   17  134  103
##   C   79  180  354  229  178
##   D    0    0    0    0    0
##   E    3    0    0    0  342
# Out of sample accuracy of classification method is 52.63% which is very less than random forest.   
sum(diag(pred_test)) / nrow(test_vif)
## [1] 0.498598


Comparison

Random forest Accuracy : 0.9973 Generalize boosting method Accuracy : 0.9888 Classification method accuracy : 0.5263

Accuracy of random forest is high so final validation will be made using random forest.


Final prediction of testing data set with using random forest
# our train_vif data has reduced to 34 column. So we need to create out testing dataset to sample unique column to predict classes A,B,C,D and E. Following code is reducing testing data set variable from 160 to 34 column.

set.seed(32343)
testing <- testing[,-c(1:6)] 
testing <- testing[,-c(3:30)] 
testing <- testing[,-c(6:9)] 
testing <- testing[,-c(12:21)] 
testing <- testing[,-c(13,15,16,19:35)] 
testing <- testing[,-c(19:33)] 
testing <- testing[,-c(20:29)] 
testing <- testing[,-c(22:26)] 
testing <- testing[,-c(27:41,43:52)] 
testing <- testing[,-c(30:32)] 

# Prediction with using random forest
predict(modelfit_rf,testing)
##  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 
##  B  A  B  A  A  E  D  B  A  A  B  C  B  A  E  E  A  B  B  B 
## Levels: A B C D E
   
